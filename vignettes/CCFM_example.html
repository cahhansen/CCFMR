<!DOCTYPE html>

<html xmlns="http://www.w3.org/1999/xhtml">

<head>

<meta charset="utf-8">
<meta http-equiv="Content-Type" content="text/html; charset=utf-8" />
<meta name="generator" content="pandoc" />

<meta name="viewport" content="width=device-width, initial-scale=1">

<meta name="author" content="Carly Hansen" />

<meta name="date" content="2017-01-06" />

<title>CCFM Example</title>



<style type="text/css">code{white-space: pre;}</style>
<style type="text/css">
div.sourceCode { overflow-x: auto; }
table.sourceCode, tr.sourceCode, td.lineNumbers, td.sourceCode {
  margin: 0; padding: 0; vertical-align: baseline; border: none; }
table.sourceCode { width: 100%; line-height: 100%; }
td.lineNumbers { text-align: right; padding-right: 4px; padding-left: 4px; color: #aaaaaa; border-right: 1px solid #aaaaaa; }
td.sourceCode { padding-left: 5px; }
code > span.kw { color: #007020; font-weight: bold; } /* Keyword */
code > span.dt { color: #902000; } /* DataType */
code > span.dv { color: #40a070; } /* DecVal */
code > span.bn { color: #40a070; } /* BaseN */
code > span.fl { color: #40a070; } /* Float */
code > span.ch { color: #4070a0; } /* Char */
code > span.st { color: #4070a0; } /* String */
code > span.co { color: #60a0b0; font-style: italic; } /* Comment */
code > span.ot { color: #007020; } /* Other */
code > span.al { color: #ff0000; font-weight: bold; } /* Alert */
code > span.fu { color: #06287e; } /* Function */
code > span.er { color: #ff0000; font-weight: bold; } /* Error */
code > span.wa { color: #60a0b0; font-weight: bold; font-style: italic; } /* Warning */
code > span.cn { color: #880000; } /* Constant */
code > span.sc { color: #4070a0; } /* SpecialChar */
code > span.vs { color: #4070a0; } /* VerbatimString */
code > span.ss { color: #bb6688; } /* SpecialString */
code > span.im { } /* Import */
code > span.va { color: #19177c; } /* Variable */
code > span.cf { color: #007020; font-weight: bold; } /* ControlFlow */
code > span.op { color: #666666; } /* Operator */
code > span.bu { } /* BuiltIn */
code > span.ex { } /* Extension */
code > span.pp { color: #bc7a00; } /* Preprocessor */
code > span.at { color: #7d9029; } /* Attribute */
code > span.do { color: #ba2121; font-style: italic; } /* Documentation */
code > span.an { color: #60a0b0; font-weight: bold; font-style: italic; } /* Annotation */
code > span.cv { color: #60a0b0; font-weight: bold; font-style: italic; } /* CommentVar */
code > span.in { color: #60a0b0; font-weight: bold; font-style: italic; } /* Information */
</style>



<link href="data:text/css;charset=utf-8,body%20%7B%0Abackground%2Dcolor%3A%20%23fff%3B%0Amargin%3A%201em%20auto%3B%0Amax%2Dwidth%3A%20700px%3B%0Aoverflow%3A%20visible%3B%0Apadding%2Dleft%3A%202em%3B%0Apadding%2Dright%3A%202em%3B%0Afont%2Dfamily%3A%20%22Open%20Sans%22%2C%20%22Helvetica%20Neue%22%2C%20Helvetica%2C%20Arial%2C%20sans%2Dserif%3B%0Afont%2Dsize%3A%2014px%3B%0Aline%2Dheight%3A%201%2E35%3B%0A%7D%0A%23header%20%7B%0Atext%2Dalign%3A%20center%3B%0A%7D%0A%23TOC%20%7B%0Aclear%3A%20both%3B%0Amargin%3A%200%200%2010px%2010px%3B%0Apadding%3A%204px%3B%0Awidth%3A%20400px%3B%0Aborder%3A%201px%20solid%20%23CCCCCC%3B%0Aborder%2Dradius%3A%205px%3B%0Abackground%2Dcolor%3A%20%23f6f6f6%3B%0Afont%2Dsize%3A%2013px%3B%0Aline%2Dheight%3A%201%2E3%3B%0A%7D%0A%23TOC%20%2Etoctitle%20%7B%0Afont%2Dweight%3A%20bold%3B%0Afont%2Dsize%3A%2015px%3B%0Amargin%2Dleft%3A%205px%3B%0A%7D%0A%23TOC%20ul%20%7B%0Apadding%2Dleft%3A%2040px%3B%0Amargin%2Dleft%3A%20%2D1%2E5em%3B%0Amargin%2Dtop%3A%205px%3B%0Amargin%2Dbottom%3A%205px%3B%0A%7D%0A%23TOC%20ul%20ul%20%7B%0Amargin%2Dleft%3A%20%2D2em%3B%0A%7D%0A%23TOC%20li%20%7B%0Aline%2Dheight%3A%2016px%3B%0A%7D%0Atable%20%7B%0Amargin%3A%201em%20auto%3B%0Aborder%2Dwidth%3A%201px%3B%0Aborder%2Dcolor%3A%20%23DDDDDD%3B%0Aborder%2Dstyle%3A%20outset%3B%0Aborder%2Dcollapse%3A%20collapse%3B%0A%7D%0Atable%20th%20%7B%0Aborder%2Dwidth%3A%202px%3B%0Apadding%3A%205px%3B%0Aborder%2Dstyle%3A%20inset%3B%0A%7D%0Atable%20td%20%7B%0Aborder%2Dwidth%3A%201px%3B%0Aborder%2Dstyle%3A%20inset%3B%0Aline%2Dheight%3A%2018px%3B%0Apadding%3A%205px%205px%3B%0A%7D%0Atable%2C%20table%20th%2C%20table%20td%20%7B%0Aborder%2Dleft%2Dstyle%3A%20none%3B%0Aborder%2Dright%2Dstyle%3A%20none%3B%0A%7D%0Atable%20thead%2C%20table%20tr%2Eeven%20%7B%0Abackground%2Dcolor%3A%20%23f7f7f7%3B%0A%7D%0Ap%20%7B%0Amargin%3A%200%2E5em%200%3B%0A%7D%0Ablockquote%20%7B%0Abackground%2Dcolor%3A%20%23f6f6f6%3B%0Apadding%3A%200%2E25em%200%2E75em%3B%0A%7D%0Ahr%20%7B%0Aborder%2Dstyle%3A%20solid%3B%0Aborder%3A%20none%3B%0Aborder%2Dtop%3A%201px%20solid%20%23777%3B%0Amargin%3A%2028px%200%3B%0A%7D%0Adl%20%7B%0Amargin%2Dleft%3A%200%3B%0A%7D%0Adl%20dd%20%7B%0Amargin%2Dbottom%3A%2013px%3B%0Amargin%2Dleft%3A%2013px%3B%0A%7D%0Adl%20dt%20%7B%0Afont%2Dweight%3A%20bold%3B%0A%7D%0Aul%20%7B%0Amargin%2Dtop%3A%200%3B%0A%7D%0Aul%20li%20%7B%0Alist%2Dstyle%3A%20circle%20outside%3B%0A%7D%0Aul%20ul%20%7B%0Amargin%2Dbottom%3A%200%3B%0A%7D%0Apre%2C%20code%20%7B%0Abackground%2Dcolor%3A%20%23f7f7f7%3B%0Aborder%2Dradius%3A%203px%3B%0Acolor%3A%20%23333%3B%0Awhite%2Dspace%3A%20pre%2Dwrap%3B%20%0A%7D%0Apre%20%7B%0Aborder%2Dradius%3A%203px%3B%0Amargin%3A%205px%200px%2010px%200px%3B%0Apadding%3A%2010px%3B%0A%7D%0Apre%3Anot%28%5Bclass%5D%29%20%7B%0Abackground%2Dcolor%3A%20%23f7f7f7%3B%0A%7D%0Acode%20%7B%0Afont%2Dfamily%3A%20Consolas%2C%20Monaco%2C%20%27Courier%20New%27%2C%20monospace%3B%0Afont%2Dsize%3A%2085%25%3B%0A%7D%0Ap%20%3E%20code%2C%20li%20%3E%20code%20%7B%0Apadding%3A%202px%200px%3B%0A%7D%0Adiv%2Efigure%20%7B%0Atext%2Dalign%3A%20center%3B%0A%7D%0Aimg%20%7B%0Abackground%2Dcolor%3A%20%23FFFFFF%3B%0Apadding%3A%202px%3B%0Aborder%3A%201px%20solid%20%23DDDDDD%3B%0Aborder%2Dradius%3A%203px%3B%0Aborder%3A%201px%20solid%20%23CCCCCC%3B%0Amargin%3A%200%205px%3B%0A%7D%0Ah1%20%7B%0Amargin%2Dtop%3A%200%3B%0Afont%2Dsize%3A%2035px%3B%0Aline%2Dheight%3A%2040px%3B%0A%7D%0Ah2%20%7B%0Aborder%2Dbottom%3A%204px%20solid%20%23f7f7f7%3B%0Apadding%2Dtop%3A%2010px%3B%0Apadding%2Dbottom%3A%202px%3B%0Afont%2Dsize%3A%20145%25%3B%0A%7D%0Ah3%20%7B%0Aborder%2Dbottom%3A%202px%20solid%20%23f7f7f7%3B%0Apadding%2Dtop%3A%2010px%3B%0Afont%2Dsize%3A%20120%25%3B%0A%7D%0Ah4%20%7B%0Aborder%2Dbottom%3A%201px%20solid%20%23f7f7f7%3B%0Amargin%2Dleft%3A%208px%3B%0Afont%2Dsize%3A%20105%25%3B%0A%7D%0Ah5%2C%20h6%20%7B%0Aborder%2Dbottom%3A%201px%20solid%20%23ccc%3B%0Afont%2Dsize%3A%20105%25%3B%0A%7D%0Aa%20%7B%0Acolor%3A%20%230033dd%3B%0Atext%2Ddecoration%3A%20none%3B%0A%7D%0Aa%3Ahover%20%7B%0Acolor%3A%20%236666ff%3B%20%7D%0Aa%3Avisited%20%7B%0Acolor%3A%20%23800080%3B%20%7D%0Aa%3Avisited%3Ahover%20%7B%0Acolor%3A%20%23BB00BB%3B%20%7D%0Aa%5Bhref%5E%3D%22http%3A%22%5D%20%7B%0Atext%2Ddecoration%3A%20underline%3B%20%7D%0Aa%5Bhref%5E%3D%22https%3A%22%5D%20%7B%0Atext%2Ddecoration%3A%20underline%3B%20%7D%0A%0Acode%20%3E%20span%2Ekw%20%7B%20color%3A%20%23555%3B%20font%2Dweight%3A%20bold%3B%20%7D%20%0Acode%20%3E%20span%2Edt%20%7B%20color%3A%20%23902000%3B%20%7D%20%0Acode%20%3E%20span%2Edv%20%7B%20color%3A%20%2340a070%3B%20%7D%20%0Acode%20%3E%20span%2Ebn%20%7B%20color%3A%20%23d14%3B%20%7D%20%0Acode%20%3E%20span%2Efl%20%7B%20color%3A%20%23d14%3B%20%7D%20%0Acode%20%3E%20span%2Ech%20%7B%20color%3A%20%23d14%3B%20%7D%20%0Acode%20%3E%20span%2Est%20%7B%20color%3A%20%23d14%3B%20%7D%20%0Acode%20%3E%20span%2Eco%20%7B%20color%3A%20%23888888%3B%20font%2Dstyle%3A%20italic%3B%20%7D%20%0Acode%20%3E%20span%2Eot%20%7B%20color%3A%20%23007020%3B%20%7D%20%0Acode%20%3E%20span%2Eal%20%7B%20color%3A%20%23ff0000%3B%20font%2Dweight%3A%20bold%3B%20%7D%20%0Acode%20%3E%20span%2Efu%20%7B%20color%3A%20%23900%3B%20font%2Dweight%3A%20bold%3B%20%7D%20%20code%20%3E%20span%2Eer%20%7B%20color%3A%20%23a61717%3B%20background%2Dcolor%3A%20%23e3d2d2%3B%20%7D%20%0A" rel="stylesheet" type="text/css" />

</head>

<body>




<h1 class="title toc-ignore">CCFM Example</h1>
<h4 class="author"><em>Carly Hansen</em></h4>
<h4 class="date"><em>2017-01-06</em></h4>



<div id="traditional-change-factor-methodology-single-and-multiple-cf" class="section level1">
<h1>Traditional Change Factor Methodology (single and multiple CF)</h1>
<div id="setup" class="section level2">
<h2>Setup</h2>
<p>Load necessary libraries, and read in data and format by subsetting a specificed model into future and baseline periods. (Note that periods for the baseline and the observed dataset should be the same).</p>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r"><span class="co">#Load Libraries</span>
<span class="kw">library</span>(CCFMR)
<span class="kw">library</span>(lubridate)</code></pre></div>
<pre><code>## 
## Attaching package: 'lubridate'</code></pre>
<pre><code>## The following object is masked from 'package:base':
## 
##     date</code></pre>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r"><span class="co">#Read in data</span>
slcbcca=slc_bcca

<span class="co">#Limit data to specified time period for a specified model</span>
baseperiod=<span class="kw">c</span>(<span class="dv">1955</span>,<span class="dv">1984</span>)
futureperiod=<span class="kw">c</span>(<span class="dv">1985</span>,<span class="dv">2014</span>)
base=<span class="kw">formatperiods</span>(slcbcca,<span class="st">&quot;gfdl-esm2g.1.rcp26&quot;</span>,baseperiod)
future=<span class="kw">formatperiods</span>(slcbcca,<span class="st">&quot;gfdl-esm2g.1.rcp26&quot;</span>,futureperiod)
obs=<span class="kw">formatperiods</span>(slc_obs,<span class="st">&quot;ObservedPrecip&quot;</span>,baseperiod)

comparison=<span class="kw">formatperiods</span>(slc_obs,<span class="st">&quot;ObservedPrecip&quot;</span>,futureperiod)</code></pre></div>
</div>
<div id="single-change-factor-approach" class="section level2">
<h2>Single Change Factor Approach</h2>
<p>Calculate the additive and multiplicative change factors using the average daily values.</p>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r"><span class="co">#Find average precipitation volume for each day of the year</span>
futureavg=<span class="kw">avgdaily</span>(future)
baseavg=<span class="kw">avgdaily</span>(base)
<span class="co">#Calculate additive and multiplicative change factors</span>
add=<span class="kw">calccf</span>(baseavg,futureavg,<span class="dt">cftype=</span><span class="st">&quot;additive&quot;</span>)
mult=<span class="kw">calccf</span>(baseavg,futureavg,<span class="dt">cftype=</span><span class="st">&quot;multiplicative&quot;</span>)</code></pre></div>
<p>Apply the change factors to the historical observations from the same time period as the baseline period.</p>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r"><span class="co">#Calculate the day of the year for observed data</span>
obs$DOY=<span class="kw">yday</span>(obs$Date)

<span class="co">#Apply corresponding cf to observed dataset</span>
scaledadd=<span class="kw">scalesingle</span>(add,obs,<span class="dt">cftype=</span><span class="st">&quot;additive&quot;</span>)
scaledmult=<span class="kw">scalesingle</span>(mult,obs,<span class="dt">cftype=</span><span class="st">&quot;multiplicative&quot;</span>)</code></pre></div>
</div>
<div id="multiple-100-change-factor-approach" class="section level2">
<h2>Multiple (100) Change Factor Approach</h2>
<p>Calculate the change factor for each percentile from 1-100</p>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r"><span class="co">#Calculate the percentiles (ECDF) of modeled values</span>
base=<span class="kw">calcecdf</span>(base,<span class="st">&quot;Precip&quot;</span>)
future=<span class="kw">calcecdf</span>(future,<span class="st">&quot;Precip&quot;</span>)

<span class="co">#Calculate the percentiles (ECDF) of the observed values</span>
obs=<span class="kw">calcecdf</span>(obs,<span class="st">&quot;Precip&quot;</span>)

<span class="co">#Calculate the change factors by percentile</span>
percent=<span class="kw">data.frame</span>(<span class="dt">percentlow=</span><span class="kw">seq</span>(<span class="dv">1</span>,<span class="dv">100</span>))

for (i in <span class="kw">seq</span>(<span class="dv">0</span>,<span class="dv">99</span>)){
    percent$base[i<span class="dv">+1</span>]=<span class="kw">mean</span>(base[(base$percentlow==i),<span class="st">&quot;Precip&quot;</span>])
    percent$future[i<span class="dv">+1</span>]=<span class="kw">mean</span>(future[(future$percentlow==i),<span class="st">&quot;Precip&quot;</span>])
}
percent$base[<span class="kw">is.nan</span>(percent$base)]=<span class="dv">0</span>
percent$future[<span class="kw">is.nan</span>(percent$future)]=<span class="dv">0</span>

percent$addcf=percent$future-percent$base
percent$multcf=percent$future/percent$base
percent$multcf[<span class="kw">is.nan</span>(percent$multcf)]=<span class="dv">0</span>

<span class="co">#Visualize Results by plotting precip against the percentiles</span>
<span class="kw">plot</span>(<span class="dt">x=</span>base$Precip,<span class="dt">y=</span>base$percentile,<span class="dt">ylab=</span><span class="st">'Percentile'</span>,<span class="dt">xlab=</span><span class="st">'Precipitation (mm/day)'</span>,<span class="dt">main=</span><span class="st">'ECDF'</span>,<span class="dt">col=</span><span class="dv">2</span>)
<span class="kw">points</span>(<span class="dt">x=</span>future$Precip,<span class="dt">y=</span>future$percentile,<span class="dt">col=</span><span class="dv">4</span>)
<span class="kw">points</span>(<span class="dt">x=</span>obs$Precip,<span class="dt">y=</span>obs$percentile,<span class="dt">col=</span><span class="dv">3</span>)</code></pre></div>
<p><img src="data:image/png;base64,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" alt /><!-- --></p>
<p>Apply multiple change factors</p>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r"><span class="co">#Apply multiple change factors (additive and multiplicative only)</span>
scaledma=<span class="kw">scalemultiple</span>(obs,<span class="st">&quot;additive&quot;</span>,<span class="dt">percentdf=</span>percent)
scaledmm=<span class="kw">scalemultiple</span>(obs,<span class="st">&quot;multiplicative&quot;</span>,<span class="dt">percentdf=</span>percent)</code></pre></div>
</div>
</div>
<div id="combined-change-factor-methodology" class="section level1">
<h1>Combined Change Factor Methodology</h1>
<p>Create Difference and Ratio Plots: Following the suggestion of Anandhi, et al., use ratios and difference plots to determine which type of change factor might be the most appropriate (if there is a curve, large slope, or large variation over a range in one CF type, use the other type. If there is no difference, use default of the multiplicative).</p>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r"><span class="co">#Calculate ratio and differences for each bin</span>
diff=percent$future-percent$base
ratio=percent$future/percent$base

<span class="kw">plot</span>(<span class="dt">x=</span>diff,<span class="dt">y=</span><span class="kw">seq</span>(<span class="dv">1</span>,<span class="dv">100</span>),<span class="dt">xlab=</span><span class="st">'Difference of Future-Baseline'</span>,<span class="dt">ylab=</span><span class="st">'Percentile'</span>)
<span class="kw">plot</span>(<span class="dt">x=</span>ratio,<span class="dt">y=</span><span class="kw">seq</span>(<span class="dv">1</span>,<span class="dv">100</span>),<span class="dt">xlab=</span><span class="st">'Ratio of Future/Baseline'</span>,<span class="dt">ylab=</span><span class="st">'Percentile'</span>)</code></pre></div>
<p><img src="data:image/png;base64,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" alt /><img src="data:image/png;base64,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" alt /></p>
<div id="ccfm---single" class="section level2">
<h2>CCFM - Single</h2>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r"><span class="co">#Format a dataframe for the combined change factor method</span>
scaledccfms=<span class="kw">merge</span>(obs,add,<span class="dt">by=</span><span class="st">&quot;DOY&quot;</span>)
scaledccfms=<span class="kw">merge</span>(scaledccfms,mult,<span class="dt">by=</span><span class="st">&quot;DOY&quot;</span>)
<span class="kw">names</span>(scaledccfms)=<span class="kw">c</span>(<span class="st">&quot;DOY&quot;</span>,<span class="st">&quot;Date&quot;</span>,<span class="st">&quot;Precip&quot;</span>,<span class="st">&quot;percentile&quot;</span>,<span class="st">&quot;percentlow&quot;</span>,<span class="st">&quot;addcf&quot;</span>,<span class="st">&quot;multcf&quot;</span>)</code></pre></div>
<p>Apply the change factor type for different ranges, using difference/ratio plots as a guide, and set a threshold for when the near-maxima values should use the additive change factor (regardless of difference/ratio plot results, which may not be very helpful near the maxima).</p>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r"><span class="co">#Apply the single change factors over the specified ranges</span>
scaledccfms=<span class="kw">ccfm</span>(scaledccfms,<span class="st">&quot;Precip&quot;</span>,<span class="st">&quot;addcf&quot;</span>,<span class="st">&quot;multcf&quot;</span>,<span class="dv">60</span>,<span class="dv">95</span>)

<span class="co">#Remove extra precipitation events</span>
scaledccfms[(scaledccfms$Precip==<span class="dv">0</span>),<span class="st">&quot;scaled&quot;</span>]=<span class="dv">0</span></code></pre></div>
</div>
<div id="ccfm---multiple" class="section level2">
<h2>CCFM - Multiple</h2>
<p>Apply the change factor type for different ranges, using difference/ratio plots as a guide, and set a threshold for when the near-maxima values should use the additive change factor (regardless of difference/ratio plot results, which may not be very helpful near the maxima).</p>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r">scaledccfmm=scaledmm

<span class="co">#Apply the multiple change factors over the specified ranges</span>
scaledccfmm=<span class="kw">ccfm</span>(scaledccfmm,<span class="st">&quot;Precip&quot;</span>,<span class="st">&quot;addcf&quot;</span>,<span class="st">&quot;multcf&quot;</span>,<span class="dv">60</span>,<span class="dv">95</span>)

<span class="co">#Remove extra precipitation events</span>
scaledccfmm[(scaledccfmm$Precip==<span class="dv">0</span>),<span class="st">&quot;scaled&quot;</span>]=<span class="dv">0</span></code></pre></div>
</div>
</div>
<div id="summary-and-comparison-of-different-methods" class="section level1">
<h1>Summary and Comparison of different methods</h1>
<p>Calculate Summary Statistics to Compare Different Scaling Methods</p>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r"><span class="co">#Historical Observed</span>
<span class="kw">precipsummary</span>(obs,<span class="st">&quot;Precip&quot;</span>)</code></pre></div>
<pre><code>##    Min. 1st Qu.  Median    Mean 3rd Qu.    Max. 
##   0.000   0.000   0.000   1.132   0.300  57.900 
## 90% 
## 3.6 
## 95% 
## 7.4 
##  99% 
## 16.5 
## [1] 2829</code></pre>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r"><span class="co">#Future Observed</span>
<span class="kw">precipsummary</span>(comparison,<span class="st">&quot;Precip&quot;</span>)</code></pre></div>
<pre><code>##    Min. 1st Qu.  Median    Mean 3rd Qu.    Max. 
##   0.000   0.000   0.000   1.057   0.300  39.900 
## 90% 
## 3.3 
## 95% 
## 6.9 
## 99% 
##  16 
## [1] 2752</code></pre>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r"><span class="co">#-----------------------------------------------------------</span>
<span class="co">#Single Additive Change Factor</span>
<span class="kw">precipsummary</span>(scaledadd,<span class="st">&quot;scaled&quot;</span>)</code></pre></div>
<pre><code>##    Min. 1st Qu.  Median    Mean 3rd Qu.    Max. 
##  0.0000  0.0000  0.3043  1.4230  1.1070 58.2400 
##     90% 
## 3.81652 
##      95% 
## 7.491833 
##      99% 
## 16.76004 
## [1] 7212</code></pre>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r"><span class="co">#Single Multiplicative Change Factor</span>
<span class="kw">precipsummary</span>(scaledmult,<span class="st">&quot;scaled&quot;</span>)</code></pre></div>
<pre><code>##     Min.  1st Qu.   Median     Mean  3rd Qu.     Max. 
##   0.0000   0.0000   0.0000   1.5120   0.2122 192.2000 
##      90% 
## 3.842079 
##      95% 
## 8.713868 
##      99% 
## 23.68051 
## [1] 2829</code></pre>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r"><span class="co">#Combined Single Change Factors</span>
<span class="kw">precipsummary</span>(scaledccfms,<span class="st">&quot;scaled&quot;</span>)</code></pre></div>
<pre><code>##    Min. 1st Qu.  Median    Mean 3rd Qu.    Max. 
##  0.0000  0.0000  0.0000  1.2810  0.2122 58.2400 
##      90% 
## 3.992538 
##      95% 
## 8.901158 
##      99% 
## 18.09193 
## [1] 2829</code></pre>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r"><span class="co">#------------------------------------------------------------</span>
<span class="co">#Multiple Additive Change Factors</span>
<span class="kw">precipsummary</span>(scaledma,<span class="st">&quot;addscaled&quot;</span>)</code></pre></div>
<pre><code>##     Min.  1st Qu.   Median     Mean  3rd Qu.     Max. 
##  0.00003  0.00003  0.00003  1.24000  0.43550 60.00000 
##      90% 
## 3.911986 
##      95% 
## 7.979582 
##      99% 
## 17.69025 
## [1] 10958</code></pre>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r"><span class="co">#Multiple Multiplicative Change Factors</span>
<span class="kw">precipsummary</span>(scaledmm,<span class="st">&quot;multscaled&quot;</span>)</code></pre></div>
<pre><code>##    Min. 1st Qu.  Median    Mean 3rd Qu.    Max. 
##   0.000   0.000   0.000   1.276   0.342  66.080 
##      90% 
## 3.975817 
##      95% 
## 8.190161 
##      99% 
## 18.94533 
## [1] 2829</code></pre>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r"><span class="co">#Combined Multiple Change Factors</span>
<span class="kw">precipsummary</span>(scaledccfmm,<span class="st">&quot;scaled&quot;</span>)</code></pre></div>
<pre><code>##    Min. 1st Qu.  Median    Mean 3rd Qu.    Max. 
##   0.000   0.000   0.000   1.235   0.342  60.000 
##      90% 
## 3.975817 
##      95% 
## 7.979582 
##      99% 
## 17.69025 
## [1] 2829</code></pre>
<p>Plot scaled values</p>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r">scaledccfmm$FutureDate=scaledccfmm$Date+(<span class="kw">round</span>(<span class="fl">365.25</span>*<span class="dv">40</span>))</code></pre></div>
</div>



<!-- dynamically load mathjax for compatibility with self-contained -->
<script>
  (function () {
    var script = document.createElement("script");
    script.type = "text/javascript";
    script.src  = "https://cdn.mathjax.org/mathjax/latest/MathJax.js?config=TeX-AMS-MML_HTMLorMML";
    document.getElementsByTagName("head")[0].appendChild(script);
  })();
</script>

</body>
</html>
